
@{
    if (Session["Message"] != null)
    {
        <label class="alert-danger text-center">@Session["Message"]</label>        
        Session["Message"] = null;
    }
}


@using (Ajax.BeginForm("Change", "Priority", new AjaxOptions
{
    InsertionMode = InsertionMode.Replace,
    UpdateTargetId = "concret_task",
    LoadingElementId = "loader"
}, new { @class = "text-center", enctype = "multipart/form-data" }))
{
    <div>
        <span>Приоритет:</span>
        <input type="text" name="priorityValue" id="priorValue" style="width:70px" /><hr />
        <input type="file" style="text-align:center" id="inputFile" name="uploadfile" />   <hr />
        <input type="submit" id="submitButton" value="Загрузить" />  <br /><br />
    </div>
}

<script type="text/javascript">

    $(document).ready(function () {

        var file;
        var txt;

        $('#submitButton').prop('disabled', true);

        function buttonState() {
            if (txt >= 0 && txt <= 255 && txt != "" && file != null) {
                $('#submitButton').prop('disabled', false);
            }
            else {
                $('#submitButton').prop('disabled', true);
            }
        }

        $('#inputFile').on("change", function () {
            file = $(this).val();
            buttonState();

        });

        $('#priorValue').keyup(function () {
            txt = $(this).val();
            buttonState();
        });
    });


    // Restricts input for the given textbox to the given inputFilter.
    function setInputFilter(textbox, inputFilter) {
        ["input", "keydown", "keyup", "mousedown", "mouseup", "select", "contextmenu", "drop"].forEach(function (event) {
            textbox.addEventListener(event, function () {
                if (inputFilter(this.value)) {
                    this.oldValue = this.value;
                    this.oldSelectionStart = this.selectionStart;
                    this.oldSelectionEnd = this.selectionEnd;
                } else if (this.hasOwnProperty("oldValue")) {
                    this.value = this.oldValue;
                    this.setSelectionRange(this.oldSelectionStart, this.oldSelectionEnd);
                }
            });
        });
    }

    // Restrict input to digits by using a regular expression filter.
    setInputFilter(document.getElementById("priorValue"), function (value) {
        return /^[0-9]*$/.test(value);
    });

</script>

@*<script src="~/Scripts/uploadFile.js"></script>*@  @*    Деактивирует кнопку загрузки файла пока не выбран файл    *@


